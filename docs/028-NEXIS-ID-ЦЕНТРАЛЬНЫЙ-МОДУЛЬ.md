# 028 - NEXIS ID: ЦЕНТРАЛЬНЫЙ МОДУЛЬ

**Дата:** 26.12.2025  
**Статус:** 🚀 В РАБОТЕ  
**Приоритет:** МАКСИМАЛЬНЫЙ

---

## 🎯 КОНЦЕПЦИЯ NEXIS ID

**NEXIS ID** — это центральный модуль экосистемы, который:
1. Управляет **аутентификацией** (вход/выход)
2. Хранит **профиль пользователя**
3. Контролирует **безопасность** (2FA, сессии)
4. Управляет **ролями и правами**
5. Служит **единым входом** во все модули

```
┌─────────────────────────────────────────────────────────────┐
│                        NEXIS ID                             │
│                   (Центральный модуль)                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   Auth      │  │   Profile   │  │  Security   │        │
│  │             │  │             │  │             │        │
│  │ • Login     │  │ • Данные    │  │ • 2FA       │        │
│  │ • Register  │  │ • Аватар    │  │ • Сессии    │        │
│  │ • OAuth2    │  │ • Настройки │  │ • Пароль    │        │
│  │ • Logout    │  │ • Статус    │  │ • Активность│        │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘        │
│         │                │                │                │
│         └────────────────┴────────────────┘                │
│                          │                                  │
│                    ROLES & PERMISSIONS                      │
│                          │                                  │
│         ┌────────────────┼────────────────┐                │
│         ▼                ▼                ▼                │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   Connect   │  │  Workspace  │  │    Cloud    │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 👥 СИСТЕМА РОЛЕЙ

### Текущие роли:
- `ROLE_USER` — Обычный пользователь
- `ROLE_ADMIN` — Администратор

### НОВЫЕ РОЛИ (рекомендация):

| Роль | Код | Описание | Права |
|------|-----|----------|-------|
| **User** | `ROLE_USER` | Обычный пользователь | Базовые функции |
| **Premium** | `ROLE_PREMIUM` | Премиум подписка | Расширенное хранилище, без рекламы |
| **Moderator** | `ROLE_MODERATOR` | Модератор контента | Удаление постов, бан пользователей |
| **Developer** | `ROLE_DEVELOPER` | Разработчик | Доступ к API, создание приложений |
| **Admin** | `ROLE_ADMIN` | Администратор | Полный доступ |
| **Super Admin** | `ROLE_SUPER_ADMIN` | Суперадмин | Управление администраторами |

### Иерархия прав:
```
ROLE_SUPER_ADMIN
    └── ROLE_ADMIN
            └── ROLE_MODERATOR
                    └── ROLE_DEVELOPER
                            └── ROLE_PREMIUM
                                    └── ROLE_USER
```

---

## 📋 ЧТО НУЖНО ДОРАБОТАТЬ В NEXIS ID

### 1. Backend (Kotlin/Spring):

#### Роли:
- [ ] Добавить новые роли в БД
- [ ] Создать иерархию прав
- [ ] Role-based access control (RBAC)

#### Профиль:
- [ ] Загрузка аватара
- [ ] Редактирование профиля (API)
- [ ] Социальные ссылки
- [ ] Статус пользователя

#### Безопасность:
- [ ] 2FA (TOTP - Google Authenticator)
- [ ] Управление сессиями
- [ ] История входов
- [ ] Смена пароля
- [ ] Верификация email

#### OAuth2:
- [ ] Вход через Google
- [ ] Вход через GitHub
- [ ] Вход через Apple (опционально)

### 2. Frontend (React):

#### Страницы:
- [ ] Улучшить Dashboard (Hub для модулей)
- [ ] Страница профиля (редактирование)
- [ ] Страница безопасности (2FA, сессии)
- [ ] Admin Panel (для администраторов)
- [ ] Страница настроек (полноценная)

#### Компоненты:
- [ ] User Menu (выпадающее меню)
- [ ] Role Badge (отображение роли)
- [ ] Session Manager (список сессий)
- [ ] Avatar Upload (загрузка аватара)

---

## 🔧 ПЛАН РЕАЛИЗАЦИИ (СЕГОДНЯ)

### Шаг 1: Добавить новые роли (Backend)
- Миграция БД с новыми ролями
- Обновить DataInitializer
- Добавить проверку прав

### Шаг 2: Улучшить страницу профиля (Frontend)
- Полноценное редактирование
- Отображение роли
- Статистика аккаунта

### Шаг 3: Создать страницу безопасности (Frontend)
- Смена пароля
- Список сессий
- Подготовка для 2FA

### Шаг 4: Admin Panel (для ADMIN и выше)
- Список пользователей
- Управление ролями
- Статистика системы

### Шаг 5: Улучшить Header и User Menu
- Красивое выпадающее меню
- Быстрый доступ к настройкам
- Переключение модулей

---

## 📊 СТРУКТУРА NEXIS ID

### Страницы:
```
/dashboard          - Центральный хаб (виджеты модулей)
/profile            - Профиль пользователя
/profile/edit       - Редактирование профиля
/security           - Безопасность (2FA, сессии, пароль)
/settings           - Настройки (тема, язык, уведомления)
/admin              - Admin Panel (только для ADMIN+)
/admin/users        - Управление пользователями
/admin/roles        - Управление ролями
/admin/stats        - Статистика системы
```

### API Endpoints:
```
# Профиль
GET    /api/users/me              - Текущий пользователь
PUT    /api/users/me              - Обновить профиль
POST   /api/users/me/avatar       - Загрузить аватар
DELETE /api/users/me/avatar       - Удалить аватар

# Безопасность
PUT    /api/users/me/password     - Сменить пароль
GET    /api/users/me/sessions     - Список сессий
DELETE /api/users/me/sessions/:id - Завершить сессию
POST   /api/users/me/2fa/enable   - Включить 2FA
POST   /api/users/me/2fa/disable  - Отключить 2FA
POST   /api/users/me/2fa/verify   - Проверить код 2FA

# Admin
GET    /api/admin/users           - Список пользователей
GET    /api/admin/users/:id       - Пользователь по ID
PUT    /api/admin/users/:id/role  - Изменить роль
POST   /api/admin/users/:id/ban   - Забанить
DELETE /api/admin/users/:id/ban   - Разбанить
GET    /api/admin/stats           - Статистика
```

---

## ✅ НАЧИНАЕМ!

**Порядок работы:**
1. Backend: Новые роли
2. Backend: API для профиля и безопасности
3. Frontend: Страница профиля
4. Frontend: Страница безопасности
5. Frontend: Admin Panel
6. Frontend: Улучшенный User Menu

---

*Создано: 26.12.2025*

