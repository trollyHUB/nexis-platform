# üîÑ –ü–†–ò–ú–ï–ù–ï–ù–ò–ï –ú–ò–ì–†–ê–¶–ò–ò –ë–î

**–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü posts –∏ likes –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é**

---

## üìã –ß–¢–û –°–î–ï–õ–ê–ù–û

–°–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `V2__create_posts_and_likes.sql` - –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Ç–∞–±–ª–∏—Ü posts –∏ likes
- `Post.kt` - —Å—É—â–Ω–æ—Å—Ç—å –ø–æ—Å—Ç–∞
- `Like.kt` - —Å—É—â–Ω–æ—Å—Ç—å –ª–∞–π–∫–∞
- `PostRepository.kt` - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ—Å—Ç–æ–≤
- `LikeRepository.kt` - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ª–∞–π–∫–æ–≤
- `PostService.kt` - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- `PostController.kt` - REST API endpoints

---

## üöÄ –ö–ê–ö –ü–†–ò–ú–ï–ù–ò–¢–¨ –ú–ò–ì–†–ê–¶–ò–Æ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

Flyway –ø—Ä–∏–º–µ–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ backend:

```powershell
cd C:\Users\Lenovo\IdeaProjects\identity-social
./gradlew bootRun
```

‚úÖ –í –ª–æ–≥–∞—Ö —É–≤–∏–¥–∏—à—å:
```
Flyway: Migrating schema "public" to version "2 - create posts and likes"
Flyway: Successfully applied 1 migration
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ SQL

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é:

```powershell
# 1. –ü–æ–¥–∫–ª—é—á–∏—Å—å –∫ PostgreSQL
docker exec -it identity-social-postgres-1 psql -U postgres -d identity_social_db

# 2. –í—ã–ø–æ–ª–Ω–∏ SQL –∏–∑ —Ñ–∞–π–ª–∞:
# –°–∫–æ–ø–∏—Ä—É–π —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ V2__create_posts_and_likes.sql –∏ –≤—Å—Ç–∞–≤—å –≤ psql

# 3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã:
\dt
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê

### –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å:

```sql
-- –¢–∞–±–ª–∏—Ü–∞ posts –¥–æ–ª–∂–Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
SELECT * FROM posts LIMIT 1;

-- –¢–∞–±–ª–∏—Ü–∞ likes –¥–æ–ª–∂–Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å  
SELECT * FROM likes LIMIT 1;

-- –ü—Ä–æ–≤–µ—Ä—å —Å—Ö–µ–º—É Flyway
SELECT * FROM flyway_schema_history;
```

–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å:
```
version | description              | success
--------|--------------------------|--------
2       | create posts and likes   | t
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï API

### 1. –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç:
```http
POST http://localhost:8082/api/posts
Authorization: Bearer <your-token>
Content-Type: application/json

{
  "content": "–ú–æ–π –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç! üéâ",
  "imageUrl": null
}
```

### 2. –ü–æ–ª—É—á–∏—Ç—å –ª–µ–Ω—Ç—É:
```http
GET http://localhost:8082/api/posts/feed?page=0&size=20
Authorization: Bearer <your-token>
```

### 3. –õ–∞–π–∫–Ω—É—Ç—å –ø–æ—Å—Ç:
```http
POST http://localhost:8082/api/posts/{uuid}/like
Authorization: Bearer <your-token>
```

---

## ‚ùå –ï–°–õ–ò –ú–ò–ì–†–ê–¶–ò–Ø –ù–ï –ü–†–ò–ú–ï–ù–ò–õ–ê–°–¨

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –û—à–∏–±–∫–∞ "relation posts does not exist"

**–†–µ—à–µ–Ω–∏–µ:**
```powershell
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ backend
# Flyway –ø—Ä–∏–º–µ–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
./gradlew bootRun
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∞ "version mismatch"

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –£–¥–∞–ª–∏ –∑–∞–ø–∏—Å—å –∏–∑ flyway_schema_history –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
DELETE FROM flyway_schema_history WHERE version = '2';

-- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ backend
```

---

## üìù –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:
1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏ backend
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π API –≤ Postman
3. ‚è≥ –°–æ–∑–¥–∞–π frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. ‚è≥ –û–±–Ω–æ–≤–∏ FeedPage
5. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ

---

*–°–æ–∑–¥–∞–Ω–æ: 26.12.2025 14:30*

