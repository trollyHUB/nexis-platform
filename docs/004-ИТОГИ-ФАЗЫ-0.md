# 004 - –ò–¢–û–ì–ò –§–ê–ó–´ 0 –ò –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

**–î–∞—Ç–∞:** 26.12.2025  
**–°—Ç–∞—Ç—É—Å:** –§–ê–ó–ê 0 –ó–ê–í–ï–†–®–ï–ù–ê ‚úÖ

---

## üéâ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û –°–ï–ì–û–î–ù–Ø

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
- [x] –°–æ–∑–¥–∞–Ω –ø—Ä–æ–µ–∫—Ç Spring Boot 4.0.1 + Kotlin
- [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω Gradle Kotlin DSL
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
  - Spring Web
  - Spring Security
  - Spring Data JPA
  - PostgreSQL Driver
  - Validation
  - JWT (jjwt-api, jjwt-impl, jjwt-jackson v0.12.6)

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [x] –°–æ–∑–¥–∞–Ω `docker-compose.yml` –¥–ª—è PostgreSQL 16
- [x] PostgreSQL –∑–∞–ø—É—â–µ–Ω —á–µ—Ä–µ–∑ Docker
- [x] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `identity_social_db` —Å–æ–∑–¥–∞–Ω–∞
- [x] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω `application.properties`:
  - –ü–æ—Ä—Ç: 8081
  - PostgreSQL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
  - JWT –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é)
  - Hibernate –≤ —Ä–µ–∂–∏–º–µ `update`
- [x] –û–±–Ω–æ–≤–ª—ë–Ω `.gitignore` (–¥–æ–±–∞–≤–ª–µ–Ω—ã .env —Ñ–∞–π–ª—ã)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞
- [x] –°–æ–∑–¥–∞–Ω—ã –ø–∞–ø–∫–∏:
  - `config/` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
  - `controller/` - REST –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
  - `dto/` - Data Transfer Objects
  - `entity/` - JPA —Å—É—â–Ω–æ—Å—Ç–∏
  - `repository/` - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
  - `security/` - JWT –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
  - `service/` - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] `docs/001-–ê–ù–ê–õ–ò–ó-–ò-–ü–õ–ê–ù.md` - –æ–±—â–∏–π –ø–ª–∞–Ω –ø—Ä–æ–µ–∫—Ç–∞
- [x] `docs/002-–ù–ê–°–¢–†–û–ô–ö–ê-POSTGRESQL.md` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î
- [x] `docs/003-–ü–ï–†–í–´–ô-–ó–ê–ü–£–°–ö.md` - –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- [x] `docs/README.md` - –≥–ª–∞–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢ –ó–ê–ü–£–°–ö–ê

```
Spring Boot 4.0.1 + Spring 7.0.2
Tomcat –Ω–∞ –ø–æ—Ä—Ç—É 8081
PostgreSQL 16.11 –ø–æ–¥–∫–ª—é—á–µ–Ω
Hibernate ORM 7.2.0
Spring Security –∞–∫—Ç–∏–≤–µ–Ω
```

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ:** http://localhost:8081

---

## üöÄ –°–õ–ï–î–£–Æ–©–ê–Ø –§–ê–ó–ê: –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø

### –ß—Ç–æ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å:

#### 1. –°–æ–∑–¥–∞–Ω–∏–µ Entity User
```kotlin
// entity/User.kt
@Entity
@Table(name = "users")
data class User(
    @Id @GeneratedValue
    val id: Long = 0,
    val username: String,
    val email: String,
    val password: String,  // BCrypt —Ö–µ—à
    val createdAt: LocalDateTime,
    val updatedAt: LocalDateTime
)
```

#### 2. –°–æ–∑–¥–∞–Ω–∏–µ Repository
```kotlin
// repository/UserRepository.kt
interface UserRepository : JpaRepository<User, Long> {
    fun findByUsername(username: String): User?
    fun findByEmail(email: String): User?
    fun existsByUsername(username: String): Boolean
    fun existsByEmail(email: String): Boolean
}
```

#### 3. –°–æ–∑–¥–∞–Ω–∏–µ DTO
```kotlin
// dto/AuthDto.kt
data class RegisterRequest(
    val username: String,
    val email: String,
    val password: String
)

data class LoginRequest(
    val username: String,
    val password: String
)

data class AuthResponse(
    val accessToken: String,
    val refreshToken: String,
    val user: UserDto
)
```

#### 4. JWT —Å–µ—Ä–≤–∏—Å
```kotlin
// security/JwtService.kt
- generateAccessToken(user)
- generateRefreshToken(user)
- validateToken(token)
- extractUsername(token)
```

#### 5. Security –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```kotlin
// config/SecurityConfig.kt
- –û—Ç–∫–ª—é—á–∏—Ç—å CSRF –¥–ª—è REST API
- –†–∞–∑—Ä–µ—à–∏—Ç—å /api/auth/** –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –û—Å—Ç–∞–ª—å–Ω—ã–µ endpoints —Ç—Ä–µ–±—É—é—Ç JWT
```

#### 6. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
```kotlin
// controller/AuthController.kt
POST /api/auth/register
POST /api/auth/login
POST /api/auth/refresh
```

---

## üìã –ü–†–ò–ú–ï–†–ù–´–ô –ü–û–†–Ø–î–û–ö –†–ê–ë–û–¢–´

1. **User Entity + Repository** (30 –º–∏–Ω)
2. **DTO –∫–ª–∞—Å—Å—ã** (15 –º–∏–Ω)
3. **JWT Service** (1 —á–∞—Å)
4. **UserDetailsService** (30 –º–∏–Ω)
5. **Security Config** (1 —á–∞—Å)
6. **AuthService** (1 —á–∞—Å)
7. **AuthController** (30 –º–∏–Ω)
8. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Postman** (30 –º–∏–Ω)

**–ò—Ç–æ–≥–æ: ~5-6 —á–∞—Å–æ–≤**

---

## üîß –ö–û–ú–ê–ù–î–´ –î–õ–Ø –†–ê–ë–û–¢–´

```powershell
# –ó–∞–ø—É—Å–∫ PostgreSQL
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL
docker-compose down

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
.\gradlew bootRun

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
.\gradlew build

# –¢–µ—Å—Ç—ã
.\gradlew test
```

---

## üìù –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

1. **–ü–æ—Ä—Ç 8081** - –º—ã –∏–∑–º–µ–Ω–∏–ª–∏ —Å 8080 —Ç–∞–∫ –∫–∞–∫ –æ–Ω –±—ã–ª –∑–∞–Ω—è—Ç
2. **JWT —Å–µ–∫—Ä–µ—Ç** - –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –≤ production
3. **–ü–∞—Ä–æ–ª–∏ –≤ properties** - –≤ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
4. **ddl-auto=update** - —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –≤ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Flyway

---

## üéØ –ì–û–¢–û–í –ö –°–õ–ï–î–£–Æ–©–ï–ú–£ –®–ê–ì–£?

–ù–∞–ø–∏—à–∏ "–î–∞" –∏–ª–∏ "–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º" –∏ —è –Ω–∞—á–Ω—É —Å–æ–∑–¥–∞–≤–∞—Ç—å:
1. Entity User
2. Repository
3. DTO –∫–ª–∞—Å—Å—ã

–ò–ª–∏ –µ—Å–ª–∏ —Ö–æ—á–µ—à—å —á—Ç–æ-—Ç–æ —É—Ç–æ—á–Ω–∏—Ç—å - —Å–ø—Ä–∞—à–∏–≤–∞–π!

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 26.12.2025*

